if df,dy has missings, or different dimensions, the equality tests fail.
Make a submodule or function that handles all that.
see julia dataframes handy.
